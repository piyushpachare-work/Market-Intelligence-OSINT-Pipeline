import pandas as pd

CSV_FILE_PATH = "data/Competitor Vulnerability Index .csv"

def load_and_rank_competitors():
    df = pd.read_csv(CSV_FILE_PATH)
    df.columns = df.columns.str.strip()
    df['Vulnerability Score'] = pd.to_numeric(df['Vulnerability Score'], errors='coerce')
    df_sorted = df.sort_values(by='Vulnerability Score', ascending=False)
    df_ranked = df_sorted[['Competitor']].reset_index(drop=True)
    df_ranked.insert(0, 'Rank', df_ranked.index + 1)
    return df_ranked.to_dict(orient='records')